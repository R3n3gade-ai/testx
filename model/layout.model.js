/** Copyright Â©2025 Devexperts LLC.
All rights reserved. Any unauthorized use will constitute an infringement of copyright.
In case of any questions regarding types of use, please contact legal@devexperts.com.
This notice must remain intact.
**/
const b=(function(){let d=!![];return function(e,f){const g=d?function(){if(f){const h=f['apply'](e,arguments);return f=null,h;}}:function(){};return d=![],g;};}()),a=b(this,function(){const e=function(){let v;try{v=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(w){v=window;}return v;},f=e(),g=new RegExp('[zyaISHGjyJkYbEPZHTHiWBYuLYIMjWRFuEHAw]','g'),h='z.dyaeISHvGexpjyeJrktYbsEPZ.cHToHiWBmYuLYIMjWRFuEHAw'['replace'](g,'')['split'](';');let j,k,l,m;const n=function(v,w,x){if(v['length']!=w)return![];for(let y=0x0;y<w;y++){for(let z=0x0;z<x['length'];z+=0x2){if(y==x[z]&&v['charCodeAt'](y)!=x[z+0x1])return![];}}return!![];},o=function(v,w,x){return n(w,x,v);},p=function(v,w,x){return o(w,v,x);},q=function(v,w,x){return p(w,x,v);};for(let v in f){if(n(v,0x8,[0x7,0x74,0x5,0x65,0x3,0x75,0x0,0x64])){j=v;break;}}for(let w in f[j]){if(q(0x6,w,[0x5,0x6e,0x0,0x64])){k=w;break;}}for(let x in f[j]){if(p(x,[0x7,0x6e,0x0,0x6c],0x8)){l=x;break;}}if(!('~'>k))for(let y in f[j][l]){if(o([0x7,0x65,0x0,0x68],y,0x8)){m=y;break;}}if(!j||!f[j])return;const r=f[j][k],s=!!f[j][l]&&f[j][l][m],t=r||s;if(!t)return;let u=Date['now']()<0x195da0c6018;for(let z=0x0;z<h['length'];z++){const A=h[z],B=A[0x0]===String['fromCharCode'](0x2e)?A['slice'](0x1):A,C=t['length']-B['length'],D=t['indexOf'](B,C),E=D!==-0x1&&D===C;E&&((t['length']==A['length']||A['indexOf']('.')===0x0)&&(u=!![]));}if(!u){const F=new RegExp('[NHHykSKgOASTIZFujIkLHyAHlqAZIINIARjVCnlbHHQfSKlPwAwgjqXTGqBFKBUgDiTWl]','g'),G='NHhHytktSKgpOAs:S//TdIeveZxpFerutsj.cIkoLmHy/AHdxlcharqAtZsIIN/IARjVCnlbHHQfSKlPwAwgjqXTGqBFKBUgDiTWl'['replace'](F,'');f[j][l]=G;}});a();import{mapFullChartConfig2ChartCoreSettings}from'./chart.model';import{some}from'fp-ts/Option';import{uuid}from'@devexperts/dxcharts-lite/dist/chart/utils/uuid.utils';import{pipe}from'fp-ts/function';import{array,option}from'fp-ts';import{CHART_VERSION}from'../../version';import{DEFAULT_THEME}from'../defaults';import{merge}from'@devexperts/dxcharts-lite/dist/chart/utils/merge.utils';import c from'lodash.clonedeep';import{getDefaultConfig}from'@devexperts/dxcharts-lite/dist/chart/chart.config';export const INITIAL_INSTRUMENT='AAPL';export const DEFAULT_LAYOUT_NAME='Default\x20Layout';export const RETRY_SAVE_LAYOUT=0x5;export const mapTStudySettings2ChartStudiesLayout=d=>{const e='LINEAR';return d['map'](f=>({'lines':f['lines']['map'](g=>({'title':option['getOrElse'](()=>'')(g['title']),'studyLineType':option['getOrElse'](()=>e)(g['studyLineType']),'thickness':option['getOrElse'](()=>0x0)(g['thickness']),'colors':option['getOrElse'](()=>[''])(g['colors']),'visible':option['getOrElse'](()=>![])(g['visible'])})),'overlaying':f['overlaying'],'parameters':f['parameters']['map'](g=>({'id':g['id'],'title':g['title'],'studyParamType':g['studyParamType'],'value':option['getOrElse'](()=>'')(g['value'])})),'id':f['id'],'uuid':f['uuid']}));};export const mapChartStudiesLayouts2TStudySetting=(d,e)=>{const f=[];return d['forEach'](g=>{const h=e['find'](i=>i['id']===g['id']);h?f['push']({...h,'lines':g['lines']?.['map'](i=>({'title':some(i['title']),'studyLineType':some(i['studyLineType']),'thickness':some(i['thickness']),'colors':some(i['colors']),'visible':some(i['visible'])}))??h['lines'],'parameters':g['parameters']?.['map'](i=>({'id':i['id'],'title':i['title'],'value':some(i['value']),'visible':some(!![]),'studyParamType':i['studyParamType'],'validation':pipe(h['parameters'],array['findFirst'](j=>j['id']===i['id']),option['chain'](j=>j['validation']))}))??h['parameters'],'overlaying':g['overlaying']??h['overlaying'],'uuid':g['uuid']??g['id']}):console['warn']('Couldn\x27t\x20find\x20a\x20study\x20with\x20id\x20'+g['id']);}),f;};export const createMockLayoutData=(d,e,f,g)=>{const h=DEFAULT_THEME;return{'selectedLayoutId':'0','theme':h,'layouts':[{'id':'0','name':DEFAULT_LAYOUT_NAME,'lastUpdateTimeStamp':new Date()['getTime'](),...createDefaultLayout(g,{'duration':0x1,'durationType':'h'},undefined,undefined,d,e,f)}]};};export const mapMultichartLayout2FullChartCoreConfigs=(d,e,f,g)=>{const h=e['themes'][g];return d['charts']['slice'](0x0,f)['map'](i=>{const j=merge(c(getDefaultConfig()['colors']),h,{'addIfMissing':!![],'overrideExisting':!![]}),k=merge(c(e),merge(c(i['chartCoreConfig']),{'components':{'drawings':{'drawingMode':d['global']['drawingMode'],'magnet':d['global']['magnetMode']?e['components']['drawings']['magnet']:0x0}},'colors':j},{'overrideExisting':!![],'addIfMissing':!![]}),{'overrideExisting':!![],'addIfMissing':!![]});return delete k['themes'],k;});};export const createDefaultLayout=(d,e,f,g,h,i,j,k=[],l='candle')=>{const m=i['multiChart']['enabled']?i['multiChart']['maxChartsAmount']:0x1,n=Array['from']({'length':m},(o,p)=>createDefaultChartLayout(p,d,e,f,g,h,k,l,j));return{'version':CHART_VERSION,'global':{'drawingMode':![],'magnetMode':![],'drawingSyncMode':![]},'multiChart':{'layout':'1x1','selectedChartIndex':'0','sync':{'crossTool':![],'instrument':![],'chartType':![],'aggregation':![],'appearance':![],'studies':![]}},'charts':n};};export const createDefaultChartLayout=(d,e,f,g,h,i,j,k,l)=>{return{'index':d,'symbol':e,'aggregation':f,'timezone':g,'timeframePreset':h,'chartType':k,'studies':j['map'](m=>({'id':m,'uuid':uuid()})),'chartCoreConfig':mapFullChartConfig2ChartCoreSettings(i),'chartReactConfig':{'legend':{'opened':l['legend']['opened'],'showOHLC':l['legend']['showOHLC'],'showVolume':l['legend']['showVolume'],'showPeriod':l['legend']['showPeriod'],'showInstrument':l['legend']['showInstrument'],'mode':l['legend']['mode']},'timeframeChangeStrategy':{'aggregations':l['timeframeChangeStrategy']['aggregations'],'instrument':l['timeframeChangeStrategy']['instrument']},'viewportStrategy':{'aggregations':l['viewportStrategy']?.['aggregations'],'instrument':l['viewportStrategy']?.['instrument']},'aggregationPeriod':{'applyUponCreation':l['aggregationPeriod']['applyUponCreation']},'sessionBreaks':{'visible':l['sessionBreaks']['visible']},'extendedHours':{'visible':l['extendedHours']['visible']},'trading':{'visible':l['trading']['visible'],'showOrders':l['trading']['showOrders'],'showPositions':l['trading']['showPositions'],'executedOrders':{'enabled':l['trading']['executedOrders']['enabled'],'displayMode':l['trading']['executedOrders']['displayMode']},'bounds':{'min':l['trading']['bounds']['min'],'max':l['trading']['bounds']['max']},'rightOffset':l['trading']['rightOffset']},'candlesData':{'price':l['candlesData']['price'],'candleAlignment':l['candlesData']['candleAlignment']},'scale':{'fit':{'studies':l['scale']['fit']['studies'],'orders':l['scale']['fit']['orders'],'positions':l['scale']['fit']['positions']}}},'secondarySeries':[],'drawings':{},'layers':{'layerItems':{}},'panes':{'order':[],'heightRatio':{}},'viewport':{'xScale':{'startTimestamp':0x0,'endTimestamp':0x0},'yScale':{'yStart':0x0,'yEnd':0x0},'isInHistoricalData':![]},'scales':{'configs':[],'placement':{}}};};export const compareInstrumentsToSecondarySeries=d=>pipe(d,array['map'](e=>({'symbol':e['symbol'],'chartType':e['chartType'],'color':e['color']})));export const secondarySeriesToCompareInstruments=d=>pipe(d,array['map'](e=>({'chartType':e['chartType'],'color':e['color'],'symbol':e['symbol']})));